# stock_config.py
"""
çµ±ä¸€çš„è‚¡ç¥¨é…ç½®æ¨¡çµ„
å¾ stock_split_config.json è‡ªå‹•ç”Ÿæˆ
åŒ…å«è¨“ç·´/é©—è­‰/æ¸¬è©¦åˆ†å‰²é…ç½®
"""
import json
from pathlib import Path

# å®Œæ•´è‚¡ç¥¨æ¸…å–® (180æ”¯)
ALL_STOCKS = [
    # Group A - åŠå°é«”â€§é›»å­ä¾›æ‡‰éˆ (60æ”¯)
    "2330", "2317", "2454", "2303", "2408", "2412", "2382", "2357", "2379", "3034",
    "3008", "4938", "2449", "2383", "2356", "3006", "3661", "2324", "8046", "3017",
    "6121", "3037", "3014", "3035", "3062", "3030", "3529", "5443", "2337", "8150",
    "3293", "3596", "2344", "2428", "2345", "2338", "6202", "5347", "3673", "3105",
    "6231", "6669", "4961", "4967", "6668", "4960", "3528", "6147", "3526", "6547",
    "8047", "3227", "4968", "5274", "6415", "6414", "6770", "2331", "6290", "2342",
    # Group B - å‚³ç”¢ï¼åŸç‰©æ–™ï¼†é‹è¼¸ (60æ”¯)
    "2603", "2609", "2615", "2610", "2618", "2637", "2606", "2002", "2014", "2027",
    "2201", "1201", "1216", "1301", "1303", "1326", "1710", "1717", "1722", "1723",
    "1402", "1409", "1434", "1476", "2006", "2049", "2105", "2106", "2107", "1605",
    "1609", "1608", "1612", "2308", "1727", "1730", "1101", "1102", "1108", "1210",
    "1215", "1802", "1806", "1810", "1104", "1313", "1314", "1310", "5608", "5607",
    "8105", "8940", "5534", "5609", "5603", "2023", "2028", "2114", "9933", "2501",
    # Group C - é‡‘èâ€§å…§éœ€æ¶ˆè²»ï¼ç¶ èƒ½ç”ŸæŠ€ (60æ”¯)
    "2880", "2881", "2882", "2883", "2884", "2885", "2886", "2887", "2888", "2890",
    "2891", "2892", "2812", "3665", "2834", "2850", "2801", "2836", "2845", "4807",
    "3702", "3706", "4560", "8478", "4142", "4133", "6525", "6548", "6843", "1513",
    "1514", "1516", "1521", "1522", "1524", "1533", "1708", "3019", "5904", "5906",
    "5902", "6505", "6806", "6510", "2207", "2204", "2231", "1736", "4105", "4108",
    "4162", "1909", "1702", "9917", "1217", "1218", "1737", "1783", "3708", "1795"
]

# è‚¡ç¥¨åˆ†çµ„
STOCK_GROUPS = {
    'group_A': [
        "2330", "2317", "2454", "2303", "2408", "2412", "2382", "2357", "2379", "3034",
        "3008", "4938", "2449", "2383", "2356", "3006", "3661", "2324", "8046", "3017",
        "6121", "3037", "3014", "3035", "3062", "3030", "3529", "5443", "2337", "8150",
        "3293", "3596", "2344", "2428", "2345", "2338", "6202", "5347", "3673", "3105",
        "6231", "6669", "4961", "4967", "6668", "4960", "3528", "6147", "3526", "6547",
        "8047", "3227", "4968", "5274", "6415", "6414", "6770", "2331", "6290", "2342"
    ],
    'group_B': [
        "2603", "2609", "2615", "2610", "2618", "2637", "2606", "2002", "2014", "2027",
        "2201", "1201", "1216", "1301", "1303", "1326", "1710", "1717", "1722", "1723",
        "1402", "1409", "1434", "1476", "2006", "2049", "2105", "2106", "2107", "1605",
        "1609", "1608", "1612", "2308", "1727", "1730", "1101", "1102", "1108", "1210",
        "1215", "1802", "1806", "1810", "1104", "1313", "1314", "1310", "5608", "5607",
        "8105", "8940", "5534", "5609", "5603", "2023", "2028", "2114", "9933", "2501"
    ],
    'group_C': [
        "2880", "2881", "2882", "2883", "2884", "2885", "2886", "2887", "2888", "2890",
        "2891", "2892", "2812", "3665", "2834", "2850", "2801", "2836", "2845", "4807",
        "3702", "3706", "4560", "8478", "4142", "4133", "6525", "6548", "6843", "1513",
        "1514", "1516", "1521", "1522", "1524", "1533", "1708", "3019", "5904", "5906",
        "5902", "6505", "6806", "6510", "2207", "2204", "2231", "1736", "4105", "4108",
        "4162", "1909", "1702", "9917", "1217", "1218", "1737", "1783", "3708", "1795"
    ]
}

# è¨“ç·´/é©—è­‰/æ¸¬è©¦åˆ†å‰² (å¾ stock_split_config.json)
STOCK_SPLITS = {
    'train': [
        "3673", "3035", "6415", "4938", "3661", "6121", "6414", "6290", "2428", "3017",
        "3034", "6202", "3596", "4960", "3293", "6547", "2303", "3037", "8047", "2408",
        "8150", "3008", "2342", "3014", "6669", "3062", "2330", "6668", "3030", "4968",
        "8046", "2337", "3105", "3529", "3526", "2449", "2338", "4961", "2344", "5274",
        "2383", "3528", "2308", "1608", "2603", "5607", "9933", "1710", "5608", "1810",
        "1723", "1730", "1609", "1201", "2027", "2610", "1314", "2106", "2107", "2049",
        "2105", "1102", "2609", "1612", "1409", "2002", "1727", "2501", "1402", "2014",
        "5534", "1104", "8940", "1326", "1108", "8105", "1802", "1301", "1434", "2114",
        "2201", "5603", "1605", "1717", "6510", "1783", "2845", "1218", "2886", "4807",
        "4560", "5906", "2892", "1702", "2881", "6525", "2882", "2812", "2850", "1909",
        "2231", "4108", "2204", "3665", "6806", "6843", "6505", "3702", "4105", "3708",
        "2836", "1514", "2207", "4162", "3706", "2880", "1737", "1522", "1513", "1708",
        "4142", "2884", "5904", "9917", "2891", "5902"
    ],
    'validation': [
        "2331", "2454", "5443", "5347", "2412", "2345", "3227", "4967", "2382", "2006",
        "2606", "1310", "2637", "1722", "1303", "1806", "2615", "2618", "2890", "2887",
        "2883", "2885", "1516", "1521", "2888", "2834", "8478"
    ],
    'test': [
        "6770", "2379", "2356", "3006", "2324", "6147", "2317", "2357", "6231", "1313",
        "1216", "1101", "1476", "2023", "2028", "1210", "1215", "5609", "4133", "1217",
        "6548", "3019", "1795", "2801", "1524", "1533", "1736"
    ]
}

# å‘å¾Œç›¸å®¹
STOCK_IDS = ALL_STOCKS

# åˆ†çµ„åˆ¥è‚¡ç¥¨æ¸…å–®
GROUP_A = STOCK_GROUPS['group_A']
GROUP_B = STOCK_GROUPS['group_B'] 
GROUP_C = STOCK_GROUPS['group_C']

# åˆ†å‰²åˆ¥è‚¡ç¥¨æ¸…å–®
TRAIN_STOCKS = STOCK_SPLITS['train']
VALIDATION_STOCKS = STOCK_SPLITS['validation']
TEST_STOCKS = STOCK_SPLITS['test']

def get_all_stocks():
    """ç²å–æ‰€æœ‰è‚¡ç¥¨ä»£ç¢¼"""
    return ALL_STOCKS.copy()

def get_group_stocks(group_name):
    """ç²å–æŒ‡å®šçµ„åˆ¥çš„è‚¡ç¥¨ä»£ç¢¼"""
    return STOCK_GROUPS.get(group_name, []).copy()

def get_split_stocks(split_name):
    """ç²å–æŒ‡å®šåˆ†å‰²çš„è‚¡ç¥¨ä»£ç¢¼"""
    return STOCK_SPLITS.get(split_name, []).copy()

def get_stock_count():
    """ç²å–è‚¡ç¥¨ç¸½æ•¸"""
    return len(ALL_STOCKS)

def get_split_info():
    """ç²å–åˆ†å‰²è³‡è¨Š"""
    return {
        'train': len(TRAIN_STOCKS),
        'validation': len(VALIDATION_STOCKS), 
        'test': len(TEST_STOCKS),
        'total': len(TRAIN_STOCKS) + len(VALIDATION_STOCKS) + len(TEST_STOCKS)
    }

def validate_splits():
    """é©—è­‰åˆ†å‰²é…ç½®"""
    all_split_stocks = TRAIN_STOCKS + VALIDATION_STOCKS + TEST_STOCKS
    
    # æª¢æŸ¥é‡è¤‡
    if len(set(all_split_stocks)) != len(all_split_stocks):
        return False, "åˆ†å‰²é–“æœ‰é‡è¤‡è‚¡ç¥¨"
    
    # æª¢æŸ¥ç¸½æ•¸
    if len(all_split_stocks) != 180:
        return False, f"åˆ†å‰²ç¸½æ•¸ä¸æ­£ç¢º: {len(all_split_stocks)}/180"
    
    # æª¢æŸ¥æ˜¯å¦åŒ…å«æ‰€æœ‰è‚¡ç¥¨
    missing = set(ALL_STOCKS) - set(all_split_stocks)
    if missing:
        return False, f"ç¼ºå°‘è‚¡ç¥¨: {missing}"
    
    return True, "åˆ†å‰²é…ç½®æ­£ç¢º"

if __name__ == "__main__":
    print(f"ç¸½è‚¡ç¥¨æ•¸: {get_stock_count()}")
    
    print("\nğŸ“Š åˆ†çµ„çµ±è¨ˆ:")
    for group_name in STOCK_GROUPS:
        print(f"  {group_name}: {len(get_group_stocks(group_name))} æ”¯")
    
    print("\nğŸ¯ åˆ†å‰²çµ±è¨ˆ:")
    split_info = get_split_info()
    for split_name, count in split_info.items():
        if split_name != 'total':
            percentage = (count / split_info['total']) * 100
            print(f"  {split_name}: {count} æ”¯ ({percentage:.1f}%)")
    
    print(f"\nâœ… åˆ†å‰²é©—è­‰:")
    is_valid, message = validate_splits()
    print(f"  {message}")